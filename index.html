<!DOCTYPE html>
<!-- (C) 2013-present  SheetJS http://sheetjs.com -->
<!-- vim: set ts=2: -->
<html>
<head>
<title>SheetJS JS-XLSX In-Browser HTML Table Demo</title>
<meta charset="utf-8" />
<style>
</style>
</head>
<body>
    <script src="node_modules/xlsx/xlsx.js"></script>
    <p>This is a demo to upload the xlsm file. <br> You can upload your .xlsm file from the buttom below: </p>
    <input type="file" id="file"/>
    <script>
        let input_dom_element = document.getElementById("file");
        function handleFile(e) {
            let files = e.target.files, f = files[0];
            let reader = new FileReader();
            reader.onload = function(e) {
                let data = new Uint8Array(e.target.result);
                console.log(data);
                let workbook = XLSX.read(data, {type: 'array'});
                alert("File is read.")
            };
            reader.readAsArrayBuffer(f);
        }
        input_dom_element.addEventListener("change", handleFile, false);
    </script>
</body>
</html>